<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>بوابة الشهادات | اللجنة العلمية</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root {
      --bg0: #060714; --bg1: #0B1026; --stroke: rgba(255,255,255,.08);
      --brand: #004a99; --brand2: #008c45;
      --text: rgba(255,255,255,.92);
    }
    body {
      font-family: 'Cairo', sans-serif;
      background: 
        radial-gradient(circle at 50% 0%, rgba(0,74,153,.2), transparent 50%),
        radial-gradient(circle at 100% 100%, rgba(0,140,69,.1), transparent 50%),
        var(--bg0);
      color: var(--text);
      min-height: 100vh;
      -webkit-tap-highlight-color: transparent;
    }
    .glass { background: rgba(15,23,42,0.6); backdrop-filter: blur(12px); border: 1px solid var(--stroke); }
    
    .btn-brand {
      background: linear-gradient(135deg, #004a99 0%, #008c45 100%);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .btn-brand:active { transform: scale(0.96); opacity: 0.9; }
    
    .shine-card { position: relative; overflow: hidden; }
    .shine-card::after {
      content: ""; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255,255,255,0.05), transparent);
      transform: rotate(45deg); animation: shine 4s infinite;
    }
    
    @keyframes shine { 0% { transform: translateX(-100%) rotate(45deg); } 100% { transform: translateX(100%) rotate(45deg); } }
    @keyframes scaleIn { from { transform: translateY(10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    .animate-scale { animation: scaleIn 0.4s ease-out forwards; }
    
    /* منع الـ Zoom التلقائي في الآيفون */
    input[type="text"] { font-size: 16px !important; }
  </style>
</head>

<body class="flex flex-col">

  <header class="px-4 pt-8 pb-4">
    <div class="flex flex-row-reverse justify-between items-center max-w-5xl mx-auto">
      <div class="flex items-center gap-3 text-right">
        <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-xl sm:rounded-2xl flex items-center justify-center glass border-indigo-500/20 shadow-xl">
          <i class="fa-solid fa-certificate text-indigo-400 text-lg sm:text-xl"></i>
        </div>
        <div>
          <h1 class="text-lg sm:text-xl font-black leading-none">بوابة الشهادات</h1>
          <p class="text-[9px] sm:text-[10px] text-white/40 uppercase tracking-widest mt-1">EE Club Portal</p>
        </div>
      </div>
      <a href="index.html" class="w-10 h-10 rounded-xl glass flex items-center justify-center hover:bg-white/5 transition active:scale-90">
        <i class="fa-solid fa-house text-sm text-white/60"></i>
      </a>
    </div>
  </header>

  <main class="px-4 py-6 flex-grow flex flex-col items-center">
    <div class="w-full max-w-xl">
      
      <section class="glass rounded-[2rem] p-6 sm:p-10 text-center relative overflow-hidden shadow-2xl">
        <div class="absolute -top-24 -right-24 w-64 h-64 bg-indigo-600/10 blur-[100px] rounded-full"></div>
        
        <div class="relative z-10">
          <h2 class="text-2xl sm:text-3xl font-black mb-3">استعلم عن شهادتك</h2>
          <p class="text-white/50 text-xs sm:text-sm mb-8 max-w-xs mx-auto leading-relaxed">
            أدخل الرقم الأكاديمي المكون من 9 أرقام لاستعراض كافة شهاداتك
          </p>

          <div class="space-y-4">
            <div class="relative">
              <input type="text" 
                id="studentId"
                inputmode="numeric" 
                pattern="[0-9]*"
                class="w-full bg-white/[0.03] border border-white/10 rounded-2xl px-4 py-4 sm:py-5 text-center text-xl sm:text-2xl font-black tracking-[0.15em] focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none transition-all placeholder:text-white/10 placeholder:tracking-normal" 
                placeholder="461XXXXXX" 
                maxlength="9">
            </div>
            
            <button id="searchBtn" onclick="handleSearch()" 
              class="btn-brand w-full py-4 sm:py-5 rounded-2xl font-black text-base sm:text-lg flex items-center justify-center gap-3 shadow-lg">
              <i class="fa-solid fa-magnifying-glass text-sm"></i>
              تحقق من الشهادات
            </button>
          </div>

          <div id="resultArea" class="mt-8 space-y-3"></div>
        </div>
      </section>

      <div class="mt-8 flex flex-col items-center gap-2">
         <p class="text-[9px] text-white/20 uppercase tracking-[0.2em] text-center">
           Official Educational Services &bull; RCJY
         </p>
      </div>
    </div>
  </main>

  <footer class="py-6 border-t border-white/5">
    <div class="flex items-center justify-center gap-3 opacity-30">
        <div class="text-right border-l border-white/10 pl-3">
            <span class="block text-[10px] font-black">الرصاصي</span>
            <span class="block text-[7px] uppercase">Creative Dev</span>
        </div>
        <i class="fa-solid fa-bolt text-indigo-400 text-xs"></i>
    </div>
  </footer>

  <script>
    const cloudflareBaseUrl = "https://square-lab-a7a0.mohammed-rasasi.workers.dev/";

    async function handleSearch() {
      const idInput = document.getElementById('studentId');
      const resultArea = document.getElementById('resultArea');
      const btn = document.getElementById('searchBtn');
      const id = idInput.value.trim();

      if (!/^\d{9}$/.test(id)) {
        showStatus('error', '❌ الرقم الأكاديمي يجب أن يكون 9 أرقام');
        return;
      }

      btn.disabled = true;
      resultArea.innerHTML = `
        <div class="py-10 flex flex-col items-center animate-pulse">
            <div class="w-8 h-8 border-3 border-indigo-500/20 border-t-indigo-400 rounded-full animate-spin mb-3"></div>
            <span class="text-indigo-400 font-bold text-xs">جاري فحص المجلدات...</span>
        </div>`;

      try {
        const response = await fetch(`${cloudflareBaseUrl}${id}`);

        if (response.ok) {
          const certificates = await response.json();
          resultArea.innerHTML = ""; 

          certificates.forEach((cert, index) => {
            const delay = index * 0.1;
            resultArea.innerHTML += `
              <div class="animate-scale w-full glass p-4 sm:p-5 rounded-2xl border-white/10 flex flex-col sm:flex-row items-center justify-between gap-4 shine-card" style="animation-delay: ${delay}s">
                  <div class="flex items-center gap-4 w-full sm:w-auto">
                      <div class="w-12 h-12 rounded-xl bg-indigo-500/10 flex items-center justify-center text-indigo-400 shrink-0">
                          <i class="fa-solid fa-award text-xl"></i>
                      </div>
                      <div class="text-right">
                          <span class="block text-[9px] text-indigo-400 font-bold uppercase tracking-wider mb-0.5">الدورة التدريبية</span>
                          <h4 class="font-black text-white text-sm sm:text-base">${cert.course}</h4>
                      </div>
                  </div>
                  <a href="${cert.url}" target="_blank"
                      class="w-full sm:w-auto h-11 px-6 bg-white/5 hover:bg-white/10 text-white border border-white/10 rounded-xl font-bold text-xs flex items-center justify-center gap-2 transition-all active:scale-95">
                      <i class="fa-solid fa-download text-[10px]"></i>
                      تحميل PDF
                  </a>
              </div>`;
          });
        } else {
          showStatus('error', '❌ لم نجد شهادات لهذا الرقم');
        }
      } catch (err) {
        showStatus('error', '⚠️ خطأ في الاتصال بالسيرفر');
      } finally {
        btn.disabled = false;
      }
    }

    function showStatus(type, msg) {
      const colorClass = type === 'error' ? 'text-red-400 border-red-500/20 bg-red-500/5' : 'text-indigo-400 border-indigo-500/20 bg-indigo-500/5';
      resultArea.innerHTML = `
        <div class="animate-scale p-4 rounded-xl border ${colorClass} font-bold text-xs">
            ${msg}
        </div>`;
    }

    document.getElementById('studentId').addEventListener('keypress', (e) => { if(e.key === 'Enter') handleSearch(); });
  </script>
</body>
</html>
