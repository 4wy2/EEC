<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>بوابة الشهادات | اللجنة العلمية</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root{
      --bg0:#060714; --bg1:#0B1026; --stroke: rgba(255,255,255,.08);
      --brand:#004a99; --brand2:#008c45;
      --text: rgba(255,255,255,.92);
    }
    body{
      font-family:'Cairo', sans-serif;
      background:
        radial-gradient(900px 380px at 20% 10%, rgba(0,74,153,.15), transparent 60%),
        radial-gradient(800px 340px at 80% 25%, rgba(0,140,69,.12), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      color: var(--text);
      min-height: 100vh;
    }
    .glass{ background: rgba(15,23,42,.72); backdrop-filter: blur(10px); border: 1px solid var(--stroke); }
    
    .btn-brand{
      background: linear-gradient(135deg, #004a99 0%, #008c45 100%);
      transition: all .2s ease;
    }
    .btn-brand:hover:not(:disabled){ transform: translateY(-2px); box-shadow: 0 10px 30px rgba(0,74,153,.3); filter: brightness(1.1); }
    .btn-brand:disabled { opacity: 0.5; cursor: not-allowed; }

    .shine-card { position: relative; overflow: hidden; }
    .shine-card::after {
      content: ""; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255,255,255,0.05), transparent);
      transform: rotate(45deg); animation: shine 3s infinite;
    }
    
    @keyframes shine { 0% { transform: translateX(-100%) rotate(45deg); } 100% { transform: translateX(100%) rotate(45deg); } }
    @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    .animate-scale { animation: scaleIn 0.3s ease-out forwards; }
  </style>
</head>

<body class="flex flex-col min-h-screen">

  <header class="px-6 pt-10">
    <div class="flex justify-between items-center max-w-5xl mx-auto">
      <div class="flex items-center gap-3 text-right">
        <div>
          <h1 class="text-xl font-black">بوابة الشهادات الرقمية</h1>
          <p class="text-[10px] text-white/40 uppercase tracking-widest">Electrical Engineering Club</p>
        </div>
        <div class="w-12 h-12 rounded-2xl flex items-center justify-center glass border-indigo-500/20 shadow-xl">
          <i class="fa-solid fa-certificate text-indigo-400 text-xl"></i>
        </div>
      </div>
      <a href="index.html" class="w-11 h-11 rounded-2xl glass flex items-center justify-center hover:bg-white/5 transition">
        <i class="fa-solid fa-house text-sm text-white/60"></i>
      </a>
    </div>
  </header>

  <main class="px-4 sm:px-6 py-12 flex-grow">
    <div class="max-w-3xl mx-auto">
      
      <section class="glass rounded-[2.5rem] p-8 md:p-12 text-center relative overflow-hidden">
        <div class="absolute -top-24 -right-24 w-64 h-64 bg-indigo-600/10 blur-[100px] rounded-full"></div>
        
        <div class="relative z-10">
          <h2 class="text-3xl font-black mb-4">استعلم عن شهادتك</h2>
          <p class="text-white/50 text-sm mb-10 max-w-md mx-auto leading-relaxed">
            أدخل الرقم الأكاديمي المكون من 9 أرقام لاستعراض وتحميل كافة شهادات الحضور الخاصة بك.
          </p>

          <div class="max-w-md mx-auto space-y-4">
            <div class="group relative">
              <input type="text" 
                id="studentId"
                inputmode="numeric" 
                pattern="[0-9]*"
                class="w-full bg-white/[0.03] border border-white/10 rounded-2xl px-6 py-5 text-center text-2xl font-black tracking-[0.2em] focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none transition-all placeholder:text-white/5" 
                placeholder="461XXXXXX" 
                maxlength="9">
            </div>
            
            <button id="searchBtn" onclick="handleSearch()" 
              class="btn-brand w-full py-5 rounded-2xl font-black text-lg flex items-center justify-center gap-3 tracking-wide">
              <i class="fa-solid fa-magnifying-glass text-sm"></i>
              تحقق من الشهادات
            </button>
          </div>

          <div id="resultArea" class="mt-12 min-h-[100px] flex flex-col items-center gap-4 w-full"></div>
        </div>
      </section>

      <p class="mt-10 text-center text-[10px] text-white/20 uppercase tracking-[0.3em]">
        Official Educational Services Portal &bull; RCJY
      </p>
    </div>
  </main>

  <footer class="py-8 border-t border-white/5">
    <div class="flex items-center justify-center gap-3 opacity-40 hover:opacity-100 transition-opacity">
        <div class="text-right border-l border-white/10 pl-3">
            <span class="block text-xs font-black">الرصاصي</span>
            <span class="block text-[8px] uppercase tracking-tighter">Creative Dev</span>
        </div>
        <i class="fa-solid fa-bolt text-indigo-400"></i>
    </div>
  </footer>

  <script>
    // رابط الـ Worker
    const cloudflareBaseUrl = "https://square-lab-a7a0.mohammed-rasasi.workers.dev/";

    async function handleSearch() {
      const idInput = document.getElementById('studentId');
      const resultArea = document.getElementById('resultArea');
      const btn = document.getElementById('searchBtn');
      const id = idInput.value.trim();

      if (!/^\d{9}$/.test(id)) {
        showStatus('error', '❌ يرجى إدخال رقم أكاديمي صحيح مكون من 9 أرقام');
        return;
      }

      btn.disabled = true;
      resultArea.innerHTML = `
        <div class="flex flex-col items-center animate-pulse">
            <div class="w-10 h-10 border-4 border-indigo-500/20 border-t-indigo-500 rounded-full animate-spin mb-4"></div>
            <span class="text-indigo-400 font-bold text-sm">جاري فحص جميع مسارات الدورات...</span>
        </div>`;

      try {
        // نطلب من الـ Worker قائمة الشهادات المرتبطة بهذا الرقم
        const response = await fetch(`${cloudflareBaseUrl}${id}`);

        if (response.ok) {
          const certificates = await response.json();
          resultArea.innerHTML = ""; // مسح منطقة التحميل

          certificates.forEach(cert => {
            resultArea.innerHTML += `
              <div class="animate-scale w-full glass p-6 rounded-3xl border-white/10 flex items-center justify-between shadow-xl mb-2 shine-card">
                  <div class="flex items-center gap-4 text-right">
                      <div class="w-14 h-14 rounded-2xl bg-indigo-500/10 flex items-center justify-center text-indigo-400">
                          <i class="fa-solid fa-award text-2xl"></i>
                      </div>
                      <div>
                          <span class="block text-[10px] text-indigo-400 font-black uppercase tracking-[0.2em] mb-1">دورة: ${cert.course}</span>
                          <h4 class="font-black text-white text-base">شهادة حضور معتمدة</h4>
                      </div>
                  </div>
                  <a href="${cert.url}" target="_blank"
                      class="h-12 px-6 bg-indigo-600 text-white rounded-xl font-black text-xs flex items-center justify-center hover:bg-indigo-500 transition-all shadow-lg shadow-indigo-500/20">
                      تحميل PDF
                  </a>
              </div>`;
          });
        } else {
          showStatus('error', '❌ لم نجد أي شهادات مسجلة بهذا الرقم في الأرشيف.');
        }
      } catch (err) {
        showStatus('error', '⚠️ حدث خطأ في الاتصال بالسيرفر. يرجى المحاولة لاحقاً.');
      } finally {
        btn.disabled = false;
      }
    }

    function showStatus(type, msg) {
      const colorClass = type === 'error' ? 'text-red-400 bg-red-400/10 border-red-400/20' : 'text-indigo-400 bg-indigo-400/10 border-indigo-400/20';
      resultArea.innerHTML = `
        <div class="animate-scale flex items-center gap-3 ${colorClass} px-8 py-5 rounded-2xl border font-bold text-sm">
            ${msg}
        </div>`;
    }

    document.getElementById('studentId').addEventListener('keypress', (e) => { if(e.key === 'Enter') handleSearch(); });
  </script>
</body>
</html>
